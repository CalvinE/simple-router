!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}(this,function(){return function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleRouter=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=n(1),r=n(2),s=n(4);t.SimpleRouter=function(){function e(t){o(this,e),this._config=t,this._links=[],this._outlets=[],this._routes=[],this._ignoreHashChange=!1,this._defaultRoute=null,this._notFoundRoute=null,window.onhashchange=this.onHashChange.bind(this),this.findOutlets(),this.findLinks(),this._mainOutlet=this.getMainOutlet()}return l(e,[{key:"init",value:function(){0===window.location.hash.length?this.onHashChange("/"):this.onHashChange()}},{key:"onHashChange",value:function(e){if(this._ignoreHashChange)this._ignoreHashChange=!1;else{var t="string"==typeof e||0===window.location.hash.length?"/":window.location.hash.substring(1),n={url:t,outlet:this._mainOutlet};this.initRouteHandling(n)}}},{key:"findOutlets",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"router-outlet",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;if(this.clearDeadOutlets(),n.querySelectorAll("["+t+"]").forEach(function(n,o,i){n.isRegistered||(n.isRegistered=!0,e._outlets.push(new s.Outlet(n,e.getAttributeValueByName(n,t))))},this),!this.getMainOutlet())throw"A main outlet is required."}},{key:"getMainOutlet",value:function(){return this._outlets.find(function(e){return!0===e.isMain})}},{key:"clearDeadOutlets",value:function(){this._outlets=this._outlets.filter(function(e,t,n){var o=document.body.contains(e.element);return!1===o&&(e.element.isRegistered=!1,e.element=null),o})}},{key:"findOutletByName",value:function(e){return this._outlets.find(function(t){return t.name===e},this)}},{key:"findLinks",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"route-url",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;this.clearDeadLinks(),n.querySelectorAll("["+t+"]").forEach(function(t){if(!t.isRegistered){var n=e.findOutletByName(e.getAttributeValueByName(t,"route-target"))||e.getMainOutlet();e._links.push(new u.Link(t,n,e.handleLinkClick.bind(e)))}},this)}},{key:"clearDeadLinks",value:function(){this._links=this._links.filter(function(e){var t=document.body.contains(e.element);return!1===t&&(e.element.isRegistered=!1,e.element.onclick=null,e.element=null),t})}},{key:"findRoute",value:function(e){var t=e.url===this._defaultRoute.link?this._defaultRoute:null,n=e.url.split("/"),o=null;return t="/"===e.url?this._defaultRoute:this._routes.find(function(e){var t=e.routeUrl.split("/"),i=!0;if(t.length===n.length){o={};for(var l=0;l<t.length;l++)if(n[l]===t[l])console.log("these parts match!");else{if(!0!==t[l].startsWith(":")){console.log("no route matches!"),i=!1;break}o[t[l].substring(1)]=n[l]}}else i=!1;return i},this),t||(t=this._notFoundRoute,o={linkProvided:e.url}),{route:t,params:o}}},{key:"handleLinkClick",value:function(e){e.preventDefault();var t=e.target,n=this._links.find(function(e){return t===e.element});n.outlet===this._mainOutlet&&(this._ignoreHashChange=!0,window.location.hash=n.url),this.initRouteHandling(n)}},{key:"initRouteHandling",value:function(e){var t=this.findRoute(e),n={link:e,route:t.route,params:t.params};this.handleRoute(n)}},{key:"handleRoute",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.route.postRouteProcessing&&e.route.postRouteProcessing(e),!0===this.shouldFetch(e)?(e.route.preFetchContent&&e.route.preFetchContent(e),this.fetch(e)):(e.templateTextInstance=e.route.content.html.template,this.postFetch(e))}},{key:"fetch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=new window.XMLHttpRequest;u.open(t,e.route.content.html.url,!0,i,l),u.onerror=this.handleFetchFailure,n&&n.forEach(function(e){u.setRequestHeader(e.name,e.value)},this),u.onreadystatechange=function(){u.readyState===window.XMLHttpRequest.DONE&&(e.route.content.html.template=u.responseText,e.route.content.html.loaded=!0,e.templateTextInstance=u.responseText,o.postFetch(e))},u.send()}},{key:"handleFetchFailure",value:function(e){throw e}},{key:"postFetch",value:function(e){e.route.postFetchContent&&e.route.postFetchContent(e),this.shouldLoad(e)?(e.route.preContentLoad&&e.route.preContentLoad(e),this.load(e)):this.postLoad(e)}},{key:"load",value:function(e){var t=this,n=document.getElementsByTagName("head")[0],o=!1;e.templateTextInstance&&e.link.outlet.addContentString(e.templateTextInstance);var i=e.route.content;if(i.css&&!i.css.loaded){o=!0;var l=document.createElement("link");l.rel="stylesheet",l.type="text/css",l.href=i.css.url,l.media="all",l.onload=function(){e.route.content.css.loaded=!0,t.postLoad(e)},n.appendChild(l)}if(i.js&&!i.js.loaded){o=!0;var u=document.createElement("script");u.type="application/javascript",u.src=i.js.url,u.onload=function(){e.route.content.js.loaded=!0,t.postLoad(e)},n.appendChild(u)}o||this.postLoad(e)}},{key:"postLoad",value:function(e){var t=e.route.content;t.html&&!t.html.loaded||t.css&&!t.css.loaded||t.js&&!t.js.loaded?console.log("Still waiting"):(e.route.postContentLoad&&e.route.postContentLoad(e),e.route.handler&&e.route.handler(e),e.route.postLinkHandler&&e.route.postLinkHandler(e))}},{key:"shouldFetch",value:function(e){var t=!1,n=e.route.content;return n.html&&n.html.url&&!n.html.loaded&&(t=!0),t}},{key:"shouldLoad",value:function(e){var t=!1,n=e.route.content;return e.templateTextInstance&&(t=!0),!t&&n.css&&n.css.url&&(t=!0),!t&&n.js&&n.js.url&&(t=!0),t}},{key:"handleLifeCycleFailure",value:function(e){console.error("A failure occurred in lifecycle chain!",void 0===e?"undefined":i(e),e)}},{key:"registerRoute",value:function(){"object"===i(arguments.length<=0?void 0:arguments[0])&&null!==(arguments.length<=0?void 0:arguments[0])?this._defaultRoute=new r.Route("/",arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3]):"string"==typeof(arguments.length<=0?void 0:arguments[0])?this._routes.push(new r.Route(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3],arguments.length<=4?void 0:arguments[4])):null===(arguments.length<=0?void 0:arguments[0])&&(this._notFoundRoute=new r.Route(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3],arguments.length<=4?void 0:arguments[4]))}},{key:"unregisterRoute",value:function(e){this._defaultRoute.url===e&&(this._defaultRoute.events=null)}},{key:"getAttributeValueByName",value:function(e,t){return e.attributes.getNamedItem(t).value}}]),e}()},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});t.Link=function e(t,n,i){o(this,e),this.element=t,this.url=this.element.attributes.getNamedItem("route-url").value,this.outlet=n,this.element.onclick=i,this.element.isRegistered=!0}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Route=void 0;var i=n(3);t.Route=function e(t,n){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;o(this,e),this.routeUrl=t,this.postRouteProcessing=n.postRouteProcessing,this.preFetchContent=n.preFetchContent,this.postFetchContent=n.postFetchContent,this.handler=n.handler,this.preContentLoad=n.preContentLoad,this.postContentLoad=n.postContentLoad,this.postRouteHandling=n.postRouteHandling;var s=null;l&&(s={},l.innerHTML&&!0===(0,i.isHTMLString)(l.innerHTML)?(s.template=l.innerHTML,s.loaded=!0):!0===(0,i.isHTMLString)(l)?(s.template=l,s.loaded=!0):(s.url=l,s.loaded=!1)),this.content={html:s,css:u?{url:u,loaded:!1}:null,js:r?{url:r,loaded:!1}:null}}},function(e,t,n){"use strict";function o(e){var t=(new DOMParser).parseFromString(e,i);return Array.from(t.body.childNodes).some(function(e){return 1===e.nodeType})}Object.defineProperty(t,"__esModule",{value:!0}),t.isHTMLString=o;var i=t.HTML_MIME="text/html";t.XML_MIME="application/xml",t.CSS_MIME="text/css",t.JS_MIME="application/js"},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();t.Outlet=function(){function e(t,n){o(this,e),this.element=t,this.name=n,this.isMain="main"===n}return i(e,[{key:"hasContent",value:function(){return 0!==this.element.children.length}},{key:"clearOutlet",value:function(){for(;this.element.children.length>0;)this.element.removeChild(this.element.children[0])}},{key:"addContentString",value:function(e){this.element.innerHTML=e}},{key:"addContent",value:function(e){this.element.appendChild(e)}}]),e}()}])});
//# sourceMappingURL=simple-router.js.map