!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var o in n)("object"==typeof exports?exports:t)[o]=n[o]}}(this,function(){return function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.simpleUIRouter=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=n(1),l=n(2),s=n(4),a=function(){function t(e){o(this,t),this._config=null,this._links=[],this._outlets=[],this._routes=[],this._mainOutlet=null,this._loadedURLs=[],this._isRouting=!1,this._ignoreHashChange=!1,this._defaultRoute=null,this._notFoundRoute=null,window.onhashchange=this.onHashChange.bind(this)}return u(t,[{key:"init",value:function(t){this._config=t,this.findOutlets(),this.findLinks(),this._mainOutlet=this.getMainOutlet(),0===window.location.hash.length?this.onHashChange("/"):this.onHashChange()}},{key:"onHashChange",value:function(t){if(this._ignoreHashChange)this._ignoreHashChange=!1;else{var e="string"==typeof t||0===window.location.hash.length?"/":window.location.hash.substring(1),n={url:e,outlet:this._mainOutlet};this.initRouteHandling(n,this._mainOutlet)}}},{key:"findOutlets",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"router-outlet",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;if(this.clearDeadOutlets(),n.querySelectorAll("["+e+"]").forEach(function(n,o,i){n.isRegistered||(n.isRegistered=!0,t._outlets.push(new s.Outlet(n,t.getAttributeValueByName(n,e))))},this),!this.getMainOutlet())throw"A main outlet is required."}},{key:"getMainOutlet",value:function(){return this._outlets.find(function(t){return!0===t.isMain})}},{key:"clearDeadOutlets",value:function(){this._outlets=this._outlets.filter(function(t,e,n){var o=document.body.contains(t.element);return!1===o&&(t.element.isRegistered=!1,t.element=null),o})}},{key:"findOutletByName",value:function(t){return this._outlets.find(function(e){return e.name===t},this)}},{key:"findLinks",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"route-url",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;this.clearDeadLinks(),n.querySelectorAll("["+e+"]").forEach(function(e){if(!e.isRegistered){var n=t.findOutletByName(t.getAttributeValueByName(e,"route-target"))||t.getMainOutlet();t._links.push(new r.Link(e,n,t.handleLinkClick.bind(t)))}},this)}},{key:"clearDeadLinks",value:function(){this._links=this._links.filter(function(t){var e=document.body.contains(t.element);return!1===e&&(t.element.isRegistered=!1,t.element.onclick=null,t.element=null),e})}},{key:"findRoute",value:function(t){var e=t.url===this._defaultRoute.link?this._defaultRoute:null,n=t.url.split("/"),o=null;return e="/"===t.url?this._defaultRoute:this._routes.find(function(t){var e=t.routeUrl.split("/"),i=!0;if(e.length===n.length){o={};for(var u=0;u<e.length;u++)if(n[u]===e[u]);else{if(!0!==e[u].startsWith(":")){i=!1;break}o[e[u].substring(1)]=n[u]}}else i=!1;return i},this),e||(e=this._notFoundRoute,o={linkProvided:t.url}),{route:e,params:o}}},{key:"handleLinkClick",value:function(t){t.preventDefault();var e=t.target,n=this._links.find(function(t){return e===t.element}),o=n.outlet?n.outlet:this._mainOutlet;o===this._mainOutlet&&(this._ignoreHashChange=!0,window.location.hash=n.url),this.initRouteHandling(n,o)}},{key:"initRouteHandling",value:function(t,e){this._isRouting=!0;var n=this.findRoute(t),o={link:t,outlet:e,route:n.route,params:n.params,routeContent:n.route.cloneContent()};o.outlet.currentState&&null!==o.routeContent.html&&o.outlet.currentState.route.onUnloadState&&e.currentState.route.onUnloadState(e.currentState),this.handleRoute(o)}},{key:"handleRoute",value:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.route.onPostRouteProcessing&&t.route.onPostRouteProcessing(t),!0===this.shouldFetch(t)?(t.route.onPreFetchContent&&t.route.onPreFetchContent(t),this.fetch(t)):(t.routeContent.html&&!0===t.routeContent.html[0].loaded&&(t.templateTextInstance=t.routeContent.html[0].template),this.postFetch(t))}},{key:"fetch",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=new window.XMLHttpRequest;r.open(e,t.routeContent.html[0].url,!0,i,u),r.onerror=this.handleFetchFailure,n&&n.forEach(function(t){r.setRequestHeader(t.name,t.value)},this),r.onreadystatechange=function(){r.readyState===window.XMLHttpRequest.DONE&&(t.route.content.html[0].template=r.responseText,t.route.content.html[0].loaded=!0,t.templateTextInstance=r.responseText,t.routeContent.html[0].template=r.responseText,t.routeContent.html[0].loaded=!0,t.route.onPostFetchContent&&t.route.onPostFetchContent(t),o.postFetch(t))},r.send()}},{key:"handleFetchFailure",value:function(t){throw t}},{key:"postFetch",value:function(t){this.shouldLoad(t)?(t.route.onPreContentLoad&&t.route.onPreContentLoad(t),this.loadTemplate(t),this.load(t)):(this.loadTemplate(t),this.postLoad(t))}},{key:"loadTemplate",value:function(t){t.templateTextInstance&&(t.tempalteLoaded=!0,t.outlet.addContentString(t.templateTextInstance))}},{key:"load",value:function(t){var e=this,n=document.getElementsByTagName("head")[0],o=!1;t.didLoad=!0;var i=t.routeContent;if(!t.route.isLoaded("css")){o=!0;for(var u=0;u<i.css.length;u++)!1===i.css[u].loaded&&-1===this._loadedURLs.indexOf(i.css[u].url)&&function(){var o=document.createElement("link");o.rel="stylesheet",o.type="text/css",o.href=i.css[u].url,o.srindex=u,o.media="all",o.onload=function(){t.route.content.css[o.srindex].loaded=!0,t.routeContent.css[o.srindex].loaded=!0,e._loadedURLs.push(t.routeContent.css[o.srindex].url),e.postLoad(t)},n.appendChild(o)}()}if(!t.route.isLoaded("js")){o=!0;for(var r=0;r<i.js.length;r++)!1===i.js[r].loaded&&-1===this._loadedURLs.indexOf(i.js[r].url)&&function(){var o=document.createElement("script");o.type="application/javascript",o.src=i.js[r].url,o.srindex=r,o.onload=function(){t.route.content.js[o.srindex].loaded=!0,t.routeContent.js[o.srindex].loaded=!0,e._loadedURLs.push(t.routeContent.js[o.srindex].url),e.postLoad(t)},n.appendChild(o)}()}o||this.postLoad(t)}},{key:"isRouteContentLoaded",value:function(t){return t.route.isLoaded("html")&&t.route.isLoaded("css")&&t.route.isLoaded("js")}},{key:"isNotLoaded",value:function(t){return!1===t.loaded}},{key:"postLoad",value:function(t){!0===this.isRouteContentLoaded(t)&&(!0===t.didLoad&&t.route.onPostContentLoad&&t.route.onPostContentLoad(t),t.route.handler&&t.route.handler(t),this.findOutlets(),this.findLinks(),this._mainOutlet=this.getMainOutlet(),this._isRouting=!1,null!==t.routeContent.html&&(t.outlet.currentState=t),t.route.onPostRoutingHandler&&t.route.onPostRoutingHandler(t))}},{key:"shouldFetch",value:function(t){var e=!1;return!1===t.route.isLoaded("html")&&(e=!0),e}},{key:"shouldLoad",value:function(t){var e=!1;return t.templateTextInstance&&(e=!0),!1===t.route.isLoaded("css")&&(e=!0),!1===t.route.isLoaded("js")&&(e=!0),e}},{key:"handleLifeCycleFailure",value:function(t){}},{key:"registerRoute",value:function(){"object"===i(arguments.length<=0?void 0:arguments[0])&&null!==(arguments.length<=0?void 0:arguments[0])?this._defaultRoute=new l.Route("/",arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3]):"string"==typeof(arguments.length<=0?void 0:arguments[0])?this._routes.push(new l.Route(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3],arguments.length<=4?void 0:arguments[4])):null===(arguments.length<=0?void 0:arguments[0])&&(this._notFoundRoute=new l.Route(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3],arguments.length<=4?void 0:arguments[4]))}},{key:"unregisterRoute",value:function(t){this._defaultRoute.url===t&&(this._defaultRoute.events=null)}},{key:"getAttributeValueByName",value:function(t,e){var n=t.attributes.getNamedItem(e);return n?n.value:null}}]),t}();e.simpleUIRouter=new a},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});e.Link=function t(e,n,i){o(this,t),this.element=e,this.url=this.element.attributes.getNamedItem("route-url").value,this.outlet=n,this.element.onclick=i,this.element.isRegistered=!0}},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Route=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=n(3);e.Route=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;o(this,t),this.routeUrl=e,this.onPostRouteProcessing=n.onPostRouteProcessing,this.onPreFetchContent=n.onPreFetchContent,this.onPostFetchContent=n.onPostFetchContent,this.handler=n.handler,this.onPreContentLoad=n.onPreContentLoad,this.onPostContentLoad=n.onPostContentLoad,this.onPostRoutingHandler=n.onPostRoutingHandler,this.onUnloadState=n.onUnloadState;var s=null,a=null,d=null;if(i){if(Array.isArray(i))throw"Parameter template can not be an array.";s={},i.innerHTML&&!0===(0,u.isHTMLString)(i.innerHTML)?(s.template=i.innerHTML,s.loaded=!0):!0===(0,u.isHTMLString)(i)?(s.template=i,s.loaded=!0):(s.url=i,s.loaded=!1)}r&&(a=[],Array.isArray(r)?r.forEach(function(t){a.push({url:t,loaded:!1})}):a.push({url:r,loaded:!1})),l&&(d=[],Array.isArray(l)?l.forEach(function(t){d.push({url:t,loaded:!1})}):d.push({url:l,loaded:!1})),this.content={html:s?[s]:null,css:a,js:d}}return i(t,[{key:"cloneContent",value:function(){return JSON.parse(JSON.stringify(this.content))}},{key:"isLoaded",value:function(t){return!this.content[t]||!!this.content[t]&&!this.content[t].find(function(t){return!1===t.loaded})}}]),t}()},function(t,e,n){"use strict";function o(t){var e=(new window.DOMParser).parseFromString(t,i);return Array.from(e.body.childNodes).some(function(t){return 1===t.nodeType})}Object.defineProperty(e,"__esModule",{value:!0}),e.isHTMLString=o;var i=e.HTML_MIME="text/html";e.XML_MIME="application/xml",e.CSS_MIME="text/css",e.JS_MIME="application/js"},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.Outlet=function(){function t(e,n,i){o(this,t),this.element=e,this.name=n,this.isMain="main"===n,this.defaultRoute=i,this.currentState=null}return i(t,[{key:"hasContent",value:function(){return 0!==this.element.children.length}},{key:"clearOutlet",value:function(){for(;this.element.children.length>0;)this.element.removeChild(this.element.children[0])}},{key:"addContentString",value:function(t){this.element.innerHTML=t}},{key:"addContent",value:function(t){this.element.appendChild(t)}}]),t}()}])});
//# sourceMappingURL=simple-ui-router.js.map